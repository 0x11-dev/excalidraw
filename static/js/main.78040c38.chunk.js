(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{15:function(e,t,n){e.exports=n(26)},25:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(2),o=n(5),l=n(4),i=n(6),c=n(8),u=n(0),s=n.n(u),f=n(9),h=n.n(f),d=n(12),v=n(14),m=n(7);function p(e,t,n){var a=e[t];e[t]=e[n],e[n]=a}function g(e,t){t.sort((function(e,t){return e-t}));var n=!0;t.forEach((function(t,a){(n=n&&t===a)||p(e,t-1,t)}))}function y(e,t){var n=t.sort((function(e,t){return t-e})),a=!0;n.forEach((function(t,n){(a=a&&t===e.length-n-1)||p(e,t+1,t)}))}function w(e,t){t.sort((function(e,t){return e-t}));var n=t.map((function(t){return e[t]})),a=t.reverse().concat([0]);a.forEach((function(t,n){if(0!==n)for(var r=a[n-1]-1;r>=t;--r)e[r+n]=e[r]})),n.forEach((function(t,n){e[n]=t}))}function E(e,t){var n=t.sort((function(e,t){return t-e})),a=n.map((function(t){return e[t]}));(t=n.reverse().concat([e.length])).forEach((function(n,a){if(0!==a)for(var r=t[a-1]+1;r<n;++r)e[r-a]=e[r]})),a.forEach((function(t,n){e[e.length-n-1]=t}))}n(25);var k=Array.of();function x(){return Math.floor(Math.random()*Math.pow(2,31))}function S(e,t){var n=Math.random;Math.random=function(e){return function(){return(Math.pow(2,31)-1&(e=Math.imul(48271,e)))/Math.pow(2,31)}}(e);var a=t();return Math.random=n,a}function C(e,t,n,a,r,o){var l,i,c=r-n,u=o-a,s=c*c+u*u,f=-1;0!==s&&(f=((e-n)*c+(t-a)*u)/s),f<0?(l=n,i=a):f>1?(l=r,i=o):(l=n+f*c,i=a+f*u);var h=e-l,d=t-i;return Math.hypot(h,d)}function b(e,t,n){if("ellipse"===e.type){var a=Math.abs(t-e.x-e.width/2),r=Math.abs(n-e.y-e.height/2),o=.707,l=.707,i=e.width/2,u=e.height/2;return[0,1,2,3].forEach((function(e){var t=i*o,n=u*l,c=(i*i-u*u)*Math.pow(o,3)/i,s=(u*u-i*i)*Math.pow(l,3)/u,f=t-c,h=n-s,d=a-c,v=r-s,m=Math.hypot(h,f),p=Math.hypot(v,d);o=Math.min(1,Math.max(0,(d*m/p+c)/i)),l=Math.min(1,Math.max(0,(v*m/p+s)/u));var g=Math.hypot(l,o);o/=g,l/=g})),Math.hypot(i*o-a,u*l-r)<10}if("rectangle"===e.type){var s=A(e),f=K(e),h=X(e),d=Y(e);return C(t,n,s,h,f,h)<10||C(t,n,f,h,f,d)<10||C(t,n,f,d,s,d)<10||C(t,n,s,d,s,h)<10}if("arrow"===e.type){var v=U(e),m=Object(c.a)(v,8),p=m[0],g=m[1],y=m[2],w=m[3],E=m[4],k=m[5],x=m[6],S=m[7];return C(t-=e.x,n-=e.y,E,k,y,w)<10||C(t,n,p,g,y,w)<10||C(t,n,x,S,y,w)<10}if("text"===e.type){var b=A(e),M=K(e),B=X(e),D=Y(e);return t>=b&&t<=M&&n>=B&&n<=D}if("selection"===e.type)return console.warn("This should not happen, we need to investigate why it does."),!1;throw new Error("Unimplemented type "+e.type)}function M(e,t,n){if(t){var a=t.fillStyle;"string"===typeof n.viewBackgroundColor?(t.fillStyle=n.viewBackgroundColor,t.fillRect(-.5,-.5,ee.width,ee.height)):t.clearRect(-.5,-.5,ee.width,ee.height),t.fillStyle=a,k.forEach((function(a){if(a.draw(e,t,n),a.isSelected){var r=A(a),o=K(a),l=X(a),i=Y(a),c=t.getLineDash();t.setLineDash([8,4]),t.strokeRect(r-4+n.scrollX,l-4+n.scrollY,o-r+8,i-l+8),t.setLineDash(c)}}));var r=function(e,t,n,a){var r=e*e/(e+Math.abs(n)),o={x:(n>0?0:e-r)+4,y:t-6-4,width:r-8,height:6},l=t*t/(t+Math.abs(a));return{horizontal:o,vertical:{x:e-6-4,y:(a>0?0:t-l)+4,width:6,height:l-12}}}(t.canvas.width,t.canvas.height,n.scrollX,n.scrollY);t.fillStyle="rgba(0,0,0,0.3)",t.fillRect(r.horizontal.x,r.horizontal.y,r.horizontal.width,r.horizontal.height),t.fillRect(r.vertical.x,r.vertical.y,r.vertical.width,r.vertical.height),t.fillStyle=a}}function B(e,t,n,a,r){return[(e-n)*Math.cos(r)-(t-a)*Math.sin(r)+n,(e-n)*Math.sin(r)+(t-a)*Math.cos(r)+a]}var D=d.a.generator(null,null);function O(e){return"text"===e.type}function L(e){return e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement}function U(e){var t=e.width,n=e.height,a=Math.hypot(t-0,n-0),r=Math.min(30,a/2),o=t-(t-0)/a*r,l=n-(n-0)/a*r,i=B(o,l,t,n,-20*Math.PI/180),u=Object(c.a)(i,2),s=u[0],f=u[1],h=B(o,l,t,n,20*Math.PI/180),d=Object(c.a)(h,2);return[0,0,t,n,s,f,d[0],d[1]]}function T(e){if("selection"===e.type)e.draw=function(t,n,a){var r=a.scrollX,o=a.scrollY,l=n.fillStyle;n.fillStyle="rgba(0, 0, 255, 0.10)",n.fillRect(e.x+r,e.y+o,e.width,e.height),n.fillStyle=l};else if("rectangle"===e.type){var t=S(e.seed,(function(){return D.rectangle(0,0,e.width,e.height,{stroke:e.strokeColor,fill:e.backgroundColor})}));e.draw=function(n,a,r){var o=r.scrollX,l=r.scrollY;a.translate(e.x+o,e.y+l),n.draw(t),a.translate(-e.x-o,-e.y-l)}}else if("ellipse"===e.type){var n=S(e.seed,(function(){return D.ellipse(e.width/2,e.height/2,e.width,e.height,{stroke:e.strokeColor,fill:e.backgroundColor})}));e.draw=function(t,a,r){var o=r.scrollX,l=r.scrollY;a.translate(e.x+o,e.y+l),t.draw(n),a.translate(-e.x-o,-e.y-l)}}else{if("arrow"===e.type){var a=U(e),r=Object(c.a)(a,8),o=r[0],l=r[1],i=r[2],u=r[3],s=r[4],f=r[5],h=r[6],d=r[7],v=S(e.seed,(function(){return[D.line(s,f,i,u,{stroke:e.strokeColor}),D.line(o,l,i,u,{stroke:e.strokeColor}),D.line(h,d,i,u,{stroke:e.strokeColor})]}));return void(e.draw=function(t,n,a){var r=a.scrollX,o=a.scrollY;n.translate(e.x+r,e.y+o),v.forEach((function(e){return t.draw(e)})),n.translate(-e.x-r,-e.y-o)})}if(!O(e))throw new Error("Unimplemented type "+e.type);e.draw=function(t,n,a){var r=a.scrollX,o=a.scrollY,l=n.font;n.font=e.font;var i=n.fillStyle;n.fillStyle=e.strokeColor,n.fillText(e.text,e.x+r,e.y+e.actualBoundingBoxAscent+o),n.fillStyle=i,n.font=l}}}function A(e){return e.width>=0?e.x:e.x+e.width}function K(e){return e.width>=0?e.x+e.width:e.x}function X(e){return e.height>=0?e.y:e.y+e.height}function Y(e){return e.height>=0?e.y+e.height:e.y}function I(){k.forEach((function(e){e.isSelected=!1}))}function N(){for(var e=k.length-1;e>=0;--e)k[e].isSelected&&k.splice(e,1)}var R="ArrowLeft",z="ArrowRight",P="ArrowDown",j="ArrowUp",J="Escape",V="Delete",H="Backspace",W=[{icon:m.d,value:"selection"},{icon:m.e,value:"rectangle"},{icon:m.a,value:"ellipse"},{icon:m.c,value:"arrow"},{icon:m.b,value:"text"}],F=W.map((function(e){return e.value[0]}));function q(e){return W.reduce((function(t,n){return n.value[0]!==e?t:n.value}),"selection")}function G(e){return e===R||e===z||e===P||e===j}function Q(){var e=[];return k.forEach((function(t,n){t.isSelected&&e.push(n)})),e}var Z=function(){return k.some((function(e){return e.isSelected}))},$=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return(n=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={draggingElement:null,elementType:"selection",exportBackground:!1,exportVisibleOnly:!0,exportPadding:10,currentItemStrokeColor:"#000000",currentItemBackgroundColor:"#ffffff",viewBackgroundColor:"#ffffff",scrollX:0,scrollY:0},n.onResize=function(){n.forceUpdate()},n.onKeyDown=function(e){if(!L(e.target))if(e.key===J)I(),n.forceUpdate(),e.preventDefault();else if(e.key===H||e.key===V)N(),n.forceUpdate(),e.preventDefault();else if(G(e.key)){var t=e.shiftKey?5:1;k.forEach((function(n){n.isSelected&&(e.key===R?n.x-=t:e.key===z?n.x+=t:e.key===j?n.y-=t:e.key===P&&(n.y+=t))})),n.forceUpdate(),e.preventDefault()}else e.metaKey&&e.shiftKey&&e.altKey&&"KeyB"===e.code?(n.moveOneLeft(),e.preventDefault()):e.metaKey&&e.shiftKey&&"KeyB"===e.code?(n.moveAllLeft(),e.preventDefault()):e.metaKey&&e.shiftKey&&e.altKey&&"KeyF"===e.code?(n.moveOneRight(),e.preventDefault()):e.metaKey&&e.shiftKey&&"KeyF"===e.code?(n.moveAllRight(),e.preventDefault()):e.metaKey&&"KeyA"===e.code?(k.forEach((function(e){e.isSelected=!0})),n.forceUpdate(),e.preventDefault()):F.includes(e.key.toLowerCase())&&n.setState({elementType:q(e.key)})},n.deleteSelectedElements=function(){N(),n.forceUpdate()},n.clearCanvas=function(){window.confirm("This will clear the whole canvas. Are you sure?")&&(k=[],n.setState({viewBackgroundColor:"#ffffff",scrollX:0,scrollY:0}),n.forceUpdate())},n.moveAllLeft=function(){w(k,Q()),n.forceUpdate()},n.moveOneLeft=function(){g(k,Q()),n.forceUpdate()},n.moveAllRight=function(){E(k,Q()),n.forceUpdate()},n.moveOneRight=function(){y(k,Q()),n.forceUpdate()},n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("resize",this.onResize,!1);var e=function(){try{var e=localStorage.getItem("excalidraw"),t=localStorage.getItem("excalidraw-state");return e&&(k=JSON.parse(e)).forEach((function(e){return T(e)})),t?JSON.parse(t):null}catch(n){return k=[],null}}();e&&this.setState(e)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("resize",this.onResize,!1)}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"container",onCut:function(t){t.clipboardData.setData("text/plain",JSON.stringify(k.filter((function(e){return e.isSelected})))),N(),e.forceUpdate(),t.preventDefault()},onCopy:function(e){e.clipboardData.setData("text/plain",JSON.stringify(k.filter((function(e){return e.isSelected})))),e.preventDefault()},onPaste:function(t){var n,a=t.clipboardData.getData("text");try{n=JSON.parse(a)}catch(t){}Array.isArray(n)&&n.length>0&&n[0].type&&(I(),n.forEach((function(e){e.x+=10,e.y+=10,e.seed=x(),T(e),k.push(e)})),e.forceUpdate()),t.preventDefault()}},s.a.createElement("div",{className:"sidePanel"},s.a.createElement("h4",null,"Shapes"),s.a.createElement("div",{className:"panelTools"},W.map((function(t){var n=t.value,a=t.icon;return s.a.createElement("label",{key:n,className:"tool"},s.a.createElement("input",{type:"radio",checked:e.state.elementType===n,onChange:function(){e.setState({elementType:n}),I(),e.forceUpdate()}}),s.a.createElement("div",{className:"toolIcon"},s.a.createElement(v.a,{icon:a})))}))),s.a.createElement("h4",null,"Colors"),s.a.createElement("div",{className:"panelColumn"},s.a.createElement("label",null,s.a.createElement("input",{type:"color",value:this.state.viewBackgroundColor,onChange:function(t){e.setState({viewBackgroundColor:t.target.value})}}),"Background"),s.a.createElement("label",null,s.a.createElement("input",{type:"color",value:this.state.currentItemStrokeColor,onChange:function(t){e.setState({currentItemStrokeColor:t.target.value})}}),"Shape Stroke"),s.a.createElement("label",null,s.a.createElement("input",{type:"color",value:this.state.currentItemBackgroundColor,onChange:function(t){e.setState({currentItemBackgroundColor:t.target.value})}}),"Shape Background")),s.a.createElement("h4",null,"Canvas"),s.a.createElement("div",{className:"panelColumn"},s.a.createElement("button",{onClick:this.clearCanvas,title:"Clear the canvas & reset background color"},"Clear canvas")),s.a.createElement("h4",null,"Export"),s.a.createElement("div",{className:"panelColumn"},s.a.createElement("button",{onClick:function(){!function(e){var t=e.exportBackground,n=e.exportVisibleOnly,a=e.exportPadding,r=void 0===a?10:a,o=e.viewBackgroundColor;if(!k.length)return window.alert("Cannot export empty canvas.");I(),h.a.render(s.a.createElement($,null),_,(function(){var e=1/0,a=0,l=1/0,i=0;k.forEach((function(t){e=Math.min(e,A(t)),a=Math.max(a,K(t)),l=Math.min(l,X(t)),i=Math.max(i,Y(t))}));var c=document.createElement("canvas"),u=c.getContext("2d");c.style.display="none",document.body.appendChild(c),c.width=n?a-e+2*r:ee.width,c.height=n?i-l+2*r:ee.height,t||M(te,ne,{viewBackgroundColor:null,scrollX:0,scrollY:0}),u.drawImage(ee,n?e-r:0,n?l-r:0,n?a-e+2*r:ee.width,n?i-l+2*r:ee.height,0,0,n?c.width:ee.width,n?c.height:ee.height),t||M(te,ne,{viewBackgroundColor:o,scrollX:0,scrollY:0});var s=document.createElement("a");s.setAttribute("download","excalidraw.png"),s.setAttribute("href",c.toDataURL("image/png")),s.click(),s.remove(),c!==ee&&c.remove()}))}({exportBackground:e.state.exportBackground,exportVisibleOnly:e.state.exportVisibleOnly,exportPadding:e.state.exportPadding,viewBackgroundColor:e.state.viewBackgroundColor})}},"Export to png"),s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:this.state.exportBackground,onChange:function(t){e.setState({exportBackground:t.target.checked})}}),"background"),s.a.createElement("label",null,s.a.createElement("input",{type:"checkbox",checked:this.state.exportVisibleOnly,onChange:function(t){e.setState({exportVisibleOnly:t.target.checked})}}),"visible area only"),s.a.createElement("div",null,"(padding:",s.a.createElement("input",{type:"number",value:this.state.exportPadding,onChange:function(t){e.setState({exportPadding:Number(t.target.value)})},disabled:!this.state.exportVisibleOnly}),"px)")),Z()&&s.a.createElement(s.a.Fragment,null,s.a.createElement("h4",null,"Shape options"),s.a.createElement("div",{className:"panelColumn"},s.a.createElement("button",{onClick:this.deleteSelectedElements},"Delete"),s.a.createElement("button",{onClick:this.moveOneRight},"Bring forward"),s.a.createElement("button",{onClick:this.moveAllRight},"Bring to front"),s.a.createElement("button",{onClick:this.moveOneLeft},"Send backward"),s.a.createElement("button",{onClick:this.moveAllLeft},"Send to back")))),s.a.createElement("canvas",{id:"canvas",width:window.innerWidth-250,height:window.innerHeight,onWheel:function(t){t.preventDefault();var n=t.deltaX,a=t.deltaY;e.setState((function(e){return{scrollX:e.scrollX-n,scrollY:e.scrollY-a}}))},onMouseDown:function(t){if(0===t.button){t.preventDefault(),L(document.activeElement)&&document.activeElement.blur();var n=t.clientX-t.target.offsetLeft-e.state.scrollX,a=t.clientY-t.target.offsetTop-e.state.scrollY,r=function(e,t,n,a,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,i={type:e,x:t,y:n,width:o,height:l,isSelected:!1,strokeColor:a,backgroundColor:r,seed:x(),draw:function(e,t,n){}};return i}(e.state.elementType,n,a,e.state.currentItemStrokeColor,e.state.currentItemBackgroundColor),o=!1,l=document.documentElement.style.cursor;if("selection"===e.state.elementType){for(var i=null,c=k.length-1;c>=0;--c)if(b(k[c],n,a)){i=k[c];break}i?i.isSelected||(t.shiftKey||I(),i.isSelected=!0):I(),(o=Z())&&(document.documentElement.style.cursor="move")}if(O(r)){var u=prompt("What text do you want?");if(null===u)return;r.text=u,r.font="20px Virgil";var s=ne.font;ne.font=r.font;var f=ne.measureText(r.text),h=f.actualBoundingBoxAscent,d=f.actualBoundingBoxDescent,v=f.width;r.actualBoundingBoxAscent=h,ne.font=s;var m=h+d;r.x-=v/2,r.y-=h,r.width=v,r.height=m}T(r),k.push(r),"text"===e.state.elementType?(e.setState({draggingElement:null,elementType:"selection"}),r.isSelected=!0):e.setState({draggingElement:r});var p=n,g=a,y=function(t){var n=t.target;if(n instanceof HTMLElement){if(o){var a=k.filter((function(e){return e.isSelected}));if(a.length){var r=t.clientX-n.offsetLeft-e.state.scrollX,l=t.clientY-n.offsetTop-e.state.scrollY;return a.forEach((function(e){e.x+=r-p,e.y+=l-g})),p=r,g=l,void e.forceUpdate()}}var i=e.state.draggingElement;if(i){var c=t.clientX-n.offsetLeft-i.x-e.state.scrollX,u=t.clientY-n.offsetTop-i.y-e.state.scrollY;i.width=c,i.height=t.shiftKey?c:u,T(i),"selection"===e.state.elementType&&function(e){var t=A(e),n=K(e),a=X(e),r=Y(e);k.forEach((function(e){var o=A(e),l=K(e),i=X(e),c=Y(e);e.isSelected="selection"!==e.type&&t<=o&&a<=i&&n>=l&&r>=c}))}(i),e.forceUpdate()}}};window.addEventListener("mousemove",y),window.addEventListener("mouseup",(function t(n){var a=e.state,r=a.draggingElement,i=a.elementType;if(window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",t),document.documentElement.style.cursor=l,null===r)return I(),void e.forceUpdate();"selection"===i?(o&&(o=!1),k.pop()):r.isSelected=!0,e.setState({draggingElement:null,elementType:"selection"}),e.forceUpdate()})),e.forceUpdate()}}}))}},{key:"componentDidUpdate",value:function(){var e;M(te,ne,{scrollX:this.state.scrollX,scrollY:this.state.scrollY,viewBackgroundColor:this.state.viewBackgroundColor}),e=this.state,localStorage.setItem("excalidraw",JSON.stringify(k)),localStorage.setItem("excalidraw-state",JSON.stringify(e))}}]),t}(s.a.Component),_=document.getElementById("root");h.a.render(s.a.createElement($,null),_);var ee=document.getElementById("canvas"),te=d.a.canvas(ee),ne=ee.getContext("2d");ne.translate(.5,.5),h.a.render(s.a.createElement($,null),_)}},[[15,1,2]]]);
//# sourceMappingURL=main.78040c38.chunk.js.map