(this.webpackJsonpreact=this.webpackJsonpreact||[]).push([[0],{15:function(e,t,n){e.exports=n(24)},21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(5),o=n(9),i=n(3),l=n(1),c=n(2),u=n(7),s=n(6),f=n(8),d=n(0),h=n.n(d),p=n(10),m=n.n(p),v=n(12);function g(){return Math.floor(Math.random()*Math.pow(2,31))}function y(e,t){var n=Math.random;Math.random=function(e){return function(){return(Math.pow(2,31)-1&(e=Math.imul(48271,e)))/Math.pow(2,31)}}(e);var a=t();return Math.random=n,a}var b=n(11),E=n.n(b);function w(e,t,n,a,r,o,i,l,c){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,s=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,f={id:E()(),type:e,x:t,y:n,width:u,height:s,strokeColor:a,backgroundColor:r,fillStyle:o,strokeWidth:i,roughness:l,opacity:c,isSelected:!1,seed:g(),shape:null};return f}function x(e){var t=Object(i.a)({},e);return t.id=E()(),t.seed=g(),t}function S(e,t,n,a,r,o){var i,l,c=r-n,u=o-a,s=c*c+u*u,f=-1;0!==s&&(f=((e-n)*c+(t-a)*u)/s),f<0?(i=n,l=a):f>1?(i=r,l=o):(i=n+f*c,l=a+f*u);var d=e-i,h=t-l;return Math.hypot(d,h)}function k(e,t,n,a,r){return[(e-n)*Math.cos(r)-(t-a)*Math.sin(r)+n,(e-n)*Math.sin(r)+(t-a)*Math.cos(r)+a]}function C(e){return[e.width>=0?e.x:e.x+e.width,e.height>=0?e.y:e.y+e.height,e.width>=0?e.x+e.width:e.x,e.height>=0?e.y+e.height:e.y]}function M(e){var t=Math.floor(e.width/2)+1,n=e.width,a=Math.floor(e.height/2)+1;return[t,0,n,a,t,e.height,0,a]}function O(e){var t=e.width,n=e.height,r=Math.hypot(t-0,n-0),o=Math.min(30,r/2),i=t-(t-0)/r*o,l=n-(n-0)/r*o,c=k(i,l,t,n,-20*Math.PI/180),u=Object(a.a)(c,2),s=u[0],f=u[1],d=k(i,l,t,n,20*Math.PI/180),h=Object(a.a)(d,2);return[0,0,t,n,s,f,h[0],h[1]]}function A(e,t){var n=t.scrollX,a=t.scrollY,r=e.x,o=e.x+e.width,i=e.y,l=e.y+e.height,c={},u=e.width<0?8:-8,s=e.height<0?8:-8;return Math.abs(o-r)>40&&(c.n=[r+(o-r)/2+n-4,i-4+a+s,8,8],c.s=[r+(o-r)/2+n-4,l-4+a-s,8,8]),Math.abs(l-i)>40&&(c.w=[r-4+n+u,i+(l-i)/2+a-4,8,8],c.e=[o-4+n-u,i+(l-i)/2+a-4,8,8]),c.nw=[r-4+n+u,i-4+a+s,8,8],c.ne=[o-4+n-u,i-4+a+s,8,8],c.sw=[r-4+n+u,l-4+a-s,8,8],c.se=[o-4+n-u,l-4+a-s,8,8],"arrow"===e.type?{nw:c.nw,se:c.se}:c}function j(e,t,n){if("ellipse"===e.type){var r=Math.abs(t-e.x-e.width/2),o=Math.abs(n-e.y-e.height/2),i=.707,l=.707,c=Math.abs(e.width)/2,u=Math.abs(e.height)/2;return[0,1,2,3].forEach((function(e){var t=c*i,n=u*l,a=(c*c-u*u)*Math.pow(i,3)/c,s=(u*u-c*c)*Math.pow(l,3)/u,f=t-a,d=n-s,h=r-a,p=o-s,m=Math.hypot(d,f),v=Math.hypot(p,h);i=Math.min(1,Math.max(0,(h*m/v+a)/c)),l=Math.min(1,Math.max(0,(p*m/v+s)/u));var g=Math.hypot(l,i);i/=g,l/=g})),Math.hypot(c*i-r,u*l-o)<10}if("rectangle"===e.type){var s=C(e),f=Object(a.a)(s,4),d=f[0],h=f[1],p=f[2],m=f[3];return S(t,n,d,h,p,h)<10||S(t,n,p,h,p,m)<10||S(t,n,p,m,d,m)<10||S(t,n,d,m,d,h)<10}if("diamond"===e.type){t-=e.x,n-=e.y;var v=M(e),g=Object(a.a)(v,8),y=g[0],b=g[1],E=g[2],w=g[3],x=g[4],k=g[5],A=g[6],j=g[7];return S(t,n,y,b,E,w)<10||S(t,n,E,w,x,k)<10||S(t,n,x,k,A,j)<10||S(t,n,A,j,y,b)<10}if("arrow"===e.type){var T=O(e),F=Object(a.a)(T,8),B=F[0],D=F[1],P=F[2],L=F[3],R=F[4],Y=F[5],X=F[6],N=F[7];return S(t-=e.x,n-=e.y,R,Y,P,L)<10||S(t,n,B,D,P,L)<10||S(t,n,X,N,P,L)<10}if("text"===e.type){var I=C(e),H=Object(a.a)(I,4),K=H[0],z=H[1],W=H[2],U=H[3];return t>=K&&t<=W&&n>=z&&n<=U}if("selection"===e.type)return console.warn("This should not happen, we need to investigate why it does."),!1;throw new Error("Unimplemented type "+e.type)}function T(e,t,n,a){var r=a.scrollX,o=a.scrollY;if(!e.isSelected||"text"===e.type)return!1;var i=A(e,{scrollX:r,scrollY:o}),l=Object.keys(i).filter((function(e){var a=i[e];return t+r>=a[0]&&t+r<=a[0]+a[2]&&n+o>=a[1]&&n+o<=a[1]+a[3]}));return l.length>0&&l[0]}function F(e,t,n){var a=t.x,r=t.y,o=n.scrollX,i=n.scrollY;return e.reduce((function(e,t){if(e)return e;var n=T(t,a,r,{scrollX:o,scrollY:i});return n?{element:t,resizeHandle:n}:null}),null)}function B(e){return"text"===e.type}var D="ArrowLeft",P="ArrowRight",L="ArrowDown",R="ArrowUp",Y="Enter",X="Escape",N="Delete",I="Backspace",H=/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey";function K(e){var t=e.initText,n=e.x,a=e.y,r=e.strokeColor,o=e.font,i=e.onSubmit,l=document.createElement("div");function c(e){e.stopPropagation()}function u(){l.innerText&&i(l.innerText),s()}function s(){l.onblur=null,l.onkeydown=null,l.onpaste=null,window.removeEventListener("wheel",c,!0),document.body.removeChild(l)}l.contentEditable="true",l.tabIndex=0,l.innerText=t,l.dataset.type="wysiwyg",Object.assign(l.style,{color:r,position:"absolute",top:a+"px",left:n+"px",transform:"translate(-50%, -50%)",textAlign:"center",display:"inline-block",font:o,padding:"4px",outline:"transparent",whiteSpace:"nowrap",minHeight:"1em"}),l.onkeydown=function(e){if(e.key===X)return e.preventDefault(),t?(l.innerText=t,void u()):void s();e.key===Y&&(e.preventDefault(),u())},l.onblur=u,l.onpaste=function(e){e.preventDefault();try{var t=e.clipboardData.getData("text").replace(/\n+/g," ");l.textContent=t}catch(n){}},window.addEventListener("wheel",c,!0),document.body.appendChild(l),l.focus();var f=window.getSelection();if(f){var d=document.createRange();d.selectNodeContents(l),f.removeAllRanges(),f.addRange(d)}}function z(e){return e.charAt(0).toUpperCase()+e.slice(1)}function W(e){return e instanceof HTMLElement&&"wysiwyg"===e.dataset.type||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement}function U(e,t){var n=document.createElement("div"),a=document.body;n.style.position="absolute",n.style.whiteSpace="nowrap",n.style.font=t,a.appendChild(n),n.innerText=e;var r=n.offsetWidth,o=n.offsetHeight,i=document.createElement("span");i.style.display="inline-block",i.style.overflow="hidden",i.style.width="1px",i.style.height="1px",n.appendChild(i);var l=i.offsetTop+i.offsetHeight;return document.body.removeChild(n),{width:r,height:o,baseline:l}}var J=function(e){var t=U(e.text,e.font);e.width=t.width,e.height=t.height,e.baseline=t.baseline};function V(e,t,n,r,o){var i=1/0,l=0,c=1/0,u=0;e.forEach((function(e){var t=C(e),n=Object(a.a)(t,4),r=n[0],o=n[1],s=n[2],f=n[3];i=Math.min(i,r),c=Math.min(c,o),l=Math.max(l,s),u=Math.max(u,f)})),i+=r,l+=r,c+=o,u+=o;var s=Math.max(-i,0),f=Math.max(-(t-l),0),d=Math.max(-c,0),h=Math.max(-(n-u),0),p=null;(s||f)&&(p={x:Math.min(s+4,t-15-4),y:n-6-4,width:Math.max(t-f-s-8,15),height:6});var m=null;return(d||h)&&(m={x:t-6-4,y:Math.min(d+4,n-15-4),width:6,height:Math.max(n-h-d-12,15)}),{horizontal:p,vertical:m}}function q(e){var t=Object(r.a)(e);return t.forEach((function(e){e.isSelected=!1})),t}function _(e){return e.filter((function(e){return!e.isSelected}))}function G(e){var t=[];return e.forEach((function(e,n){e.isSelected&&t.push(n)})),t}var Z=function(e){return e.some((function(e){return e.isSelected}))};function Q(e,t){var n=Array.from(new Set(e.filter((function(e){return e.isSelected})).map((function(e){return t(e)}))));return 1===n.length?n[0]:null}var $=n(13),ee=n.n($);function te(e,t,n,a,r,o){e.beginPath(),e.moveTo(t+o,n),e.lineTo(t+a-o,n),e.quadraticCurveTo(t+a,n,t+a,n+o),e.lineTo(t+a,n+r-o),e.quadraticCurveTo(t+a,n+r,t+a-o,n+r),e.lineTo(t+o,n+r),e.quadraticCurveTo(t,n+r,t,n+r-o),e.lineTo(t,n+o),e.quadraticCurveTo(t,n,t+o,n),e.closePath(),e.fill(),e.stroke()}function ne(e,t,n){var r=t.generator;if("selection"===e.type){var o=n.fillStyle;n.fillStyle="rgba(0, 0, 255, 0.10)",n.fillRect(0,0,e.width,e.height),n.fillStyle=o}else if("rectangle"===e.type)e.shape||(e.shape=y(e.seed,(function(){return r.rectangle(0,0,e.width,e.height,{stroke:e.strokeColor,fill:e.backgroundColor,fillStyle:e.fillStyle,strokeWidth:e.strokeWidth,roughness:e.roughness})}))),n.globalAlpha=e.opacity/100,t.draw(e.shape),n.globalAlpha=1;else if("diamond"===e.type)e.shape||(e.shape=y(e.seed,(function(){var t=M(e),n=Object(a.a)(t,8),o=n[0],i=n[1],l=n[2],c=n[3],u=n[4],s=n[5],f=n[6],d=n[7];return r.polygon([[o,i],[l,c],[u,s],[f,d]],{stroke:e.strokeColor,fill:e.backgroundColor,fillStyle:e.fillStyle,strokeWidth:e.strokeWidth,roughness:e.roughness})}))),n.globalAlpha=e.opacity/100,t.draw(e.shape),n.globalAlpha=1;else if("ellipse"===e.type)e.shape||(e.shape=y(e.seed,(function(){return r.ellipse(e.width/2,e.height/2,e.width,e.height,{stroke:e.strokeColor,fill:e.backgroundColor,fillStyle:e.fillStyle,strokeWidth:e.strokeWidth,roughness:e.roughness})}))),n.globalAlpha=e.opacity/100,t.draw(e.shape),n.globalAlpha=1;else{if("arrow"===e.type){var i=O(e),l=Object(a.a)(i,8),c=l[0],u=l[1],s=l[2],f=l[3],d=l[4],h=l[5],p=l[6],m=l[7],v={stroke:e.strokeColor,strokeWidth:e.strokeWidth,roughness:e.roughness};return e.shape||(e.shape=y(e.seed,(function(){return[r.line(d,h,s,f,v),r.line(c,u,s,f,v),r.line(p,m,s,f,v)]}))),n.globalAlpha=e.opacity/100,e.shape.forEach((function(e){return t.draw(e)})),void(n.globalAlpha=1)}if(!B(e))throw new Error("Unimplemented type "+e.type);n.globalAlpha=e.opacity/100;var g=n.font;n.font=e.font;var b=n.fillStyle;n.fillStyle=e.strokeColor,n.fillText(e.text,0,e.baseline||e.actualBoundingBoxAscent||0),n.fillStyle=b,n.font=g,n.globalAlpha=1}}function ae(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},l=o.offsetX,c=o.offsetY,u=o.renderScrollbars,s=void 0===u||u,f=o.renderSelection,d=void 0===f||f;if(n){var h=n.getContext("2d"),p=h.fillStyle;if("string"===typeof r.viewBackgroundColor?(h.fillStyle=r.viewBackgroundColor,h.fillRect(0,0,n.width,n.height)):h.clearRect(0,0,n.width,n.height),h.fillStyle=p,r=Object(i.a)({},r,{scrollX:"number"===typeof l?l:r.scrollX,scrollY:"number"===typeof c?c:r.scrollY}),e.forEach((function(e){h.translate(e.x+r.scrollX,e.y+r.scrollY),ne(e,t,h),h.translate(-e.x-r.scrollX,-e.y-r.scrollY)})),d){var m=e.filter((function(e){return e.isSelected}));if(m.forEach((function(e){var t=C(e),n=Object(a.a)(t,4),o=n[0],i=n[1],l=n[2],c=n[3],u=h.getLineDash();h.setLineDash([8,4]),h.strokeRect(o-4+r.scrollX,i-4+r.scrollY,l-o+8,c-i+8),h.setLineDash(u)})),1===m.length&&"text"!==m[0].type){var v=A(m[0],r);Object.values(v).forEach((function(e){h.strokeRect(e[0],e[1],e[2],e[3])}))}}if(s){var g=V(e,h.canvas.width/window.devicePixelRatio,h.canvas.height/window.devicePixelRatio,r.scrollX,r.scrollY),y=h.strokeStyle;h.fillStyle="rgba(0,0,0,0.3)",h.strokeStyle="rgba(255,255,255,0.8)",[g.horizontal,g.vertical].forEach((function(e){e&&te(h,e.x,e.y,e.width,e.height,3)})),h.strokeStyle=y,h.fillStyle=p}}}function re(e,t){var n=document.createElement("a");n.setAttribute("download",e),n.setAttribute("href",t),n.click(),n.remove()}function oe(e,t){return{elements:e.map((function(e){return Object(i.a)({},e,{id:e.id||E()(),fillStyle:e.fillStyle||"hachure",strokeWidth:e.strokeWidth||1,roughness:e.roughness||1,opacity:null===e.opacity||void 0===e.opacity?100:e.opacity})})),appState:t}}function ie(e,t,n){for(var a=null,r=e.length-1;r>=0;--r)if(j(e[r],t,n)){a=e[r];break}return a}var le=[{icon:h.a.createElement("svg",{viewBox:"0 0 320 512"},h.a.createElement("path",{d:"M302.189 329.126H196.105l55.831 135.993c3.889 9.428-.555 19.999-9.444 23.999l-49.165 21.427c-9.165 4-19.443-.571-23.332-9.714l-53.053-129.136-86.664 89.138C18.729 472.71 0 463.554 0 447.977V18.299C0 1.899 19.921-6.096 30.277 5.443l284.412 292.542c11.472 11.179 3.007 31.141-12.5 31.141z"})),value:"selection"},{icon:h.a.createElement("svg",{viewBox:"0 0 448 512"},h.a.createElement("path",{d:"M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48z"})),value:"rectangle"},{icon:h.a.createElement("svg",{viewBox:"0 0 223.646 223.646"},h.a.createElement("path",{d:"M111.823 0L16.622 111.823 111.823 223.646 207.025 111.823z"})),value:"diamond"},{icon:h.a.createElement("svg",{viewBox:"0 0 512 512"},h.a.createElement("path",{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"})),value:"ellipse"},{icon:h.a.createElement("svg",{viewBox:"0 0 448 512"},h.a.createElement("path",{d:"M313.941 216H12c-6.627 0-12 5.373-12 12v56c0 6.627 5.373 12 12 12h301.941v46.059c0 21.382 25.851 32.09 40.971 16.971l86.059-86.059c9.373-9.373 9.373-24.569 0-33.941l-86.059-86.059c-15.119-15.119-40.971-4.411-40.971 16.971V216z"})),value:"arrow"},{icon:h.a.createElement("svg",{viewBox:"0 0 448 512"},h.a.createElement("path",{d:"M432 416h-23.41L277.88 53.69A32 32 0 0 0 247.58 32h-47.16a32 32 0 0 0-30.3 21.69L39.41 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-19.58l23.3-64h152.56l23.3 64H304a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM176.85 272L224 142.51 271.15 272z"})),value:"text"}],ce=le.map((function(e){return e.value[0]}));var ue=function(){function e(){Object(l.a)(this,e),this.recording=!0,this.stateHistory=[],this.redoStack=[]}return Object(c.a)(e,[{key:"generateCurrentEntry",value:function(e){return JSON.stringify(e.map((function(e){e.shape;var t=Object(o.a)(e,["shape"]);return Object(i.a)({},t,{isSelected:!1})})))}},{key:"pushEntry",value:function(e){this.stateHistory.length>0&&this.stateHistory[this.stateHistory.length-1]===e||this.stateHistory.push(e)}},{key:"restoreEntry",value:function(e){this.skipRecording();try{return JSON.parse(e)}catch(t){return null}}},{key:"clearRedoStack",value:function(){this.redoStack.splice(0,this.redoStack.length)}},{key:"redoOnce",value:function(e){var t=this.generateCurrentEntry(e),n=this.redoStack.pop();return void 0!==n?(this.stateHistory.push(t),this.restoreEntry(n)):null}},{key:"undoOnce",value:function(e){var t=this.generateCurrentEntry(e),n=this.stateHistory.pop();return t===n&&(n=this.stateHistory.pop()),void 0!==n?(this.redoStack.push(t),this.restoreEntry(n)):null}},{key:"isRecording",value:function(){return this.recording}},{key:"skipRecording",value:function(){this.recording=!1}},{key:"resumeRecording",value:function(){this.recording=!0}}]),e}();function se(e){var t=e.children,n=e.left,a=e.onCloseRequest,r=e.top;return h.a.createElement("div",{className:"popover",style:{top:r,left:n}},h.a.createElement("div",{className:"cover",onClick:a,onContextMenu:function(e){e.preventDefault(),a&&a()}}),t)}var fe;n(21);function de(e){var t=e.options,n=e.onCloseRequest,a=e.top,r=e.left;return h.a.createElement(se,{onCloseRequest:n,top:a,left:r},h.a.createElement("ul",{className:"context-menu",onContextMenu:function(e){return e.preventDefault()}},t.map((function(e,t){return h.a.createElement("li",{key:t,className:"context-menu__option",onClick:n},h.a.createElement(he,e))}))))}function he(e){var t=e.label,n=e.action;return h.a.createElement("button",{className:"context-menu-option",onClick:n},t)}function pe(){if(fe)return fe;var e=document.createElement("div");return document.body.appendChild(e),fe=e}function me(){Object(p.unmountComponentAtNode)(pe())}var ve=function(e){var t=Array.of();e.options.forEach((function(e){e&&t.push(e)})),t.length&&Object(p.render)(h.a.createElement(de,{top:e.top,left:e.left,options:t,onCloseRequest:me}),pe())},ge=(n(22),function(){function e(){Object(l.a)(this,e),this.actions={},this.updater=null}return Object(c.a)(e,[{key:"setUpdater",value:function(e){this.updater=e}},{key:"registerAction",value:function(e){this.actions[e.name]=e}},{key:"handleKeyDown",value:function(e,t,n){var a=Object.values(this.actions).sort((function(e,t){return(t.keyPriority||0)-(e.keyPriority||0)})).filter((function(a){return a.keyTest&&a.keyTest(e,t,n)}));return 0===a.length?{}:(e.preventDefault(),a[0].perform(t,n,null))}},{key:"getContextMenuItems",value:function(e,t,n){return Object.values(this.actions).filter((function(e){return"contextItemLabel"in e})).sort((function(e,t){return(void 0!==e.contextMenuOrder?e.contextMenuOrder:999)-(void 0!==t.contextMenuOrder?t.contextMenuOrder:999)})).map((function(a){return{label:a.contextItemLabel,action:function(){n(a.perform(e,t,null))}}}))}},{key:"renderAction",value:function(e,t,n,a){if(this.actions[e]&&"PanelComponent"in this.actions[e]){var r=this.actions[e],o=r.PanelComponent;return h.a.createElement(o,{elements:t,appState:n,updateData:function(e){a(r.perform(t,n,e))}})}return null}}]),e}()),ye={name:"deleteSelectedElements",perform:function(e){return{elements:_(e)}},contextItemLabel:"Delete",contextMenuOrder:3,keyTest:function(e){return e.key===I||e.key===N}};function be(e,t,n){var a=e[t];e[t]=e[n],e[n]=a}function Ee(e,t){t.sort((function(e,t){return e-t}));var n=!0;return t.forEach((function(t,a){(n=n&&t===a)||be(e,t-1,t)})),e}function we(e,t){var n=t.sort((function(e,t){return t-e})),a=!0;return n.forEach((function(t,n){(a=a&&t===e.length-n-1)||be(e,t+1,t)})),e}function xe(e,t){t.sort((function(e,t){return e-t}));var n=t.map((function(t){return e[t]})),a=t.reverse().concat([0]);return a.forEach((function(t,n){if(0!==n)for(var r=a[n-1]-1;r>=t;--r)e[r+n]=e[r]})),n.forEach((function(t,n){e[n]=t})),e}function Se(e,t){var n=t.sort((function(e,t){return t-e})),a=n.map((function(t){return e[t]}));return(t=n.reverse().concat([e.length])).forEach((function(n,a){if(0!==a)for(var r=t[a-1]+1;r<n;++r)e[r-a]=e[r]})),a.forEach((function(t,n){e[e.length-n-1]=t})),e}var ke={name:"sendBackward",perform:function(e,t){return{elements:Ee(Object(r.a)(e),G(e)),appState:t}},contextItemLabel:"Send Backward",keyPriority:40,keyTest:function(e){return e[H]&&e.shiftKey&&e.altKey&&"KeyB"===e.code}},Ce={name:"bringForward",perform:function(e,t){return{elements:we(Object(r.a)(e),G(e)),appState:t}},contextItemLabel:"Bring Forward",keyPriority:40,keyTest:function(e){return e[H]&&e.shiftKey&&e.altKey&&"KeyF"===e.code}},Me={name:"sendToBack",perform:function(e,t){return{elements:xe(Object(r.a)(e),G(e)),appState:t}},contextItemLabel:"Send to Back",keyTest:function(e){return e[H]&&e.shiftKey&&"KeyB"===e.code}},Oe={name:"bringToFront",perform:function(e,t){return{elements:Se(Object(r.a)(e),G(e)),appState:t}},contextItemLabel:"Bring to Front",keyTest:function(e){return e[H]&&e.shiftKey&&"KeyF"===e.code}},Ae={name:"selectAll",perform:function(e){return{elements:e.map((function(e){return Object(i.a)({},e,{isSelected:!0})}))}},contextItemLabel:"Select All",keyTest:function(e){return e[H]&&"KeyA"===e.code}};function je(e){var t=e.options,n=e.value,a=e.onChange;return h.a.createElement("div",{className:"buttonList"},t.map((function(e){return h.a.createElement("button",{key:e.text,onClick:function(){return a(e.value)},className:n===e.value?"active":""},e.text)})))}var Te=Object(d.lazy)((function(){return n.e(2).then(n.t.bind(null,232,7))}));function Fe(e){var t=e.type,n=e.color,r=e.onChange,o=h.a.useState(!1),i=Object(a.a)(o,2),l=i[0],c=i[1];return h.a.createElement("div",null,h.a.createElement("button",{className:"swatch",style:n?{backgroundColor:n}:void 0,onClick:function(){return c(!l)}}),h.a.createElement(h.a.Suspense,{fallback:""},l?h.a.createElement(se,{onCloseRequest:function(){return c(!1)}},h.a.createElement(Te,{colors:Be[t],width:"205px",color:n||void 0,onChange:function(e){r(e.hex)}})):null),h.a.createElement("input",{type:"text",className:"swatch-input",value:n||"",onPaste:function(e){return r(e.clipboardData.getData("text"))},onChange:function(e){return r(e.target.value)}}))}var Be={canvasBackground:["#DEE6EF","#FCEAD8","#F9E0E0","#E6F1F1","#E0EDDF","#FBF5DD","#F0E6ED","#FFEDEF","#EDE5E1","#F2F0EF","#FFFFFF"],elementBackground:["#4E79A7","#F28E2C","#E15759","#76B7B2","#59A14F","#EDC949","#AF7AA1","#FF9DA7","#9C755F","#BAB0AB","#FFFFFF"],elementStroke:["#324E6B","#9B5B1D","#903839","#4C7572","#396733","#AD9336","#805976","#BA737A","#725646","#88817D","#000000"]},De=function(e){var t=e.title,n=e.colorType,a=e.onColorChange,r=e.colorValue;return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,t),h.a.createElement(Fe,{type:n,color:r,onChange:function(e){return a(e)}}))},Pe=function(e,t){return e.map((function(e){return e.isSelected?t(e):e}))},Le={name:"changeStrokeColor",perform:function(e,t,n){return{elements:Pe(e,(function(e){return Object(i.a)({},e,{shape:null,strokeColor:n})})),appState:Object(i.a)({},t,{currentItemStrokeColor:n})}},PanelComponent:function(e){var t=e.elements,n=(e.appState,e.updateData);return h.a.createElement(De,{title:"Stroke Color",colorType:"elementStroke",onColorChange:function(e){n(e)},colorValue:Q(t,(function(e){return e.strokeColor}))})}},Re={name:"changeBackgroundColor",perform:function(e,t,n){return{elements:Pe(e,(function(e){return Object(i.a)({},e,{shape:null,backgroundColor:n})})),appState:Object(i.a)({},t,{currentItemBackgroundColor:n})}},PanelComponent:function(e){var t=e.elements,n=e.updateData;return h.a.createElement(De,{title:"Background Color",colorType:"elementBackground",onColorChange:function(e){n(e)},colorValue:Q(t,(function(e){return e.backgroundColor}))})}},Ye={name:"changeFillStyle",perform:function(e,t,n){return{elements:Pe(e,(function(e){return Object(i.a)({},e,{shape:null,fillStyle:n})}))}},PanelComponent:function(e){var t=e.elements,n=e.updateData;return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,"Fill"),h.a.createElement(je,{options:[{value:"solid",text:"Solid"},{value:"hachure",text:"Hachure"},{value:"cross-hatch",text:"Cross-hatch"}],value:Q(t,(function(e){return e.fillStyle})),onChange:function(e){n(e)}}))}},Xe={name:"changeStrokeWidth",perform:function(e,t,n){return{elements:Pe(e,(function(e){return Object(i.a)({},e,{shape:null,strokeWidth:n})}))}},PanelComponent:function(e){var t=e.elements,n=(e.appState,e.updateData);return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,"Stroke Width"),h.a.createElement(je,{options:[{value:1,text:"Thin"},{value:2,text:"Bold"},{value:4,text:"Extra Bold"}],value:Q(t,(function(e){return e.strokeWidth})),onChange:function(e){return n(e)}}))}},Ne={name:"changeSloppiness",perform:function(e,t,n){return{elements:Pe(e,(function(e){return Object(i.a)({},e,{shape:null,roughness:n})}))}},PanelComponent:function(e){var t=e.elements,n=(e.appState,e.updateData);return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,"Sloppiness"),h.a.createElement(je,{options:[{value:0,text:"Draftsman"},{value:1,text:"Artist"},{value:3,text:"Cartoonist"}],value:Q(t,(function(e){return e.roughness})),onChange:function(e){return n(e)}}))}},Ie={name:"changeOpacity",perform:function(e,t,n){return{elements:Pe(e,(function(e){return Object(i.a)({},e,{shape:null,opacity:n})}))}},PanelComponent:function(e){var t=e.elements,n=e.updateData;return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,"Opacity"),h.a.createElement("input",{type:"range",min:"0",max:"100",onChange:function(e){return n(+e.target.value)},value:Q(t,(function(e){return e.opacity}))||0}))}},He={name:"changeFontSize",perform:function(e,t,n){return{elements:Pe(e,(function(e){if(B(e)){var t=Object(i.a)({},e,{shape:null,font:"".concat(n,"px ").concat(e.font.split("px ")[1])});return J(t),t}return e}))}},PanelComponent:function(e){var t=e.elements,n=e.updateData;return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,"Font size"),h.a.createElement(je,{options:[{value:16,text:"Small"},{value:20,text:"Medium"},{value:28,text:"Large"},{value:36,text:"Very Large"}],value:Q(t,(function(e){return B(e)&&+e.font.split("px ")[0]})),onChange:function(e){return n(e)}}))}},Ke={name:"changeFontFamily",perform:function(e,t,n){return{elements:Pe(e,(function(e){if(B(e)){var t=Object(i.a)({},e,{shape:null,font:"".concat(e.font.split("px ")[0],"px ").concat(n)});return J(t),t}return e}))}},PanelComponent:function(e){var t=e.elements,n=e.updateData;return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,"Font family"),h.a.createElement(je,{options:[{value:"Virgil",text:"Virgil"},{value:"Helvetica",text:"Helvetica"},{value:"Courier",text:"Courier"}],value:Q(t,(function(e){return B(e)&&e.font.split("px ")[1]})),onChange:function(e){return n(e)}}))}},ze={name:"changeViewBackgroundColor",perform:function(e,t,n){return{appState:Object(i.a)({},t,{viewBackgroundColor:n})}},PanelComponent:function(e){var t=e.appState,n=e.updateData;return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,"Canvas Background Color"),h.a.createElement(Fe,{type:"canvasBackground",color:t.viewBackgroundColor,onChange:function(e){return n(e)}}))}},We={name:"clearCanvas",perform:function(e,t,n){return{elements:[],appState:Object(i.a)({},t,{viewBackgroundColor:"#ffffff",scrollX:0,scrollY:0})}},PanelComponent:function(e){var t=e.updateData;return h.a.createElement("button",{type:"button",onClick:function(){window.confirm("This will clear the whole canvas. Are you sure?")&&t(null)},title:"Clear the canvas & reset background color"},"Clear canvas")}},Ue=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).state={value:e.value,edit:!1},n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({value:e.value})}},{key:"handleEdit",value:function(e){this.setState({value:e.target.value})}},{key:"handleBlur",value:function(){var e=this.state.value;e?(this.props.onChange(e),this.setState({edit:!1})):this.setState({value:this.props.value,edit:!1})}},{key:"render",value:function(){var e=this,t=this.state,n=t.value,a=t.edit;return h.a.createElement(d.Fragment,null,a?h.a.createElement("input",{className:"project-name-input",name:"name",maxLength:25,value:n,onChange:function(t){return e.handleEdit(t)},onBlur:function(){return e.handleBlur()},onKeyDown:function(t){"Enter"===t.key&&e.handleBlur()},autoFocus:!0}):h.a.createElement("span",{onClick:function(){return e.setState({edit:!0})},className:"project-name"},n))}}]),t}(d.Component),Je={name:"changeProjectName",perform:function(e,t,n){return{appState:Object(i.a)({},t,{name:n})}},PanelComponent:function(e){var t=e.appState,n=e.updateData;return h.a.createElement(h.a.Fragment,null,h.a.createElement("h5",null,"Name"),t.name&&h.a.createElement(Ue,{value:t.name,onChange:function(e){return n(e)}}))}},Ve={name:"changeExportBackground",perform:function(e,t,n){return{appState:Object(i.a)({},t,{exportBackground:n})}},PanelComponent:function(e){var t=e.appState,n=e.updateData;return h.a.createElement("label",null,h.a.createElement("input",{type:"checkbox",checked:t.exportBackground,onChange:function(e){n(e.target.checked)}}),"background")}},qe={name:"saveScene",perform:function(e,t,n){return function(e,t){var n=JSON.stringify({version:1,source:window.location.origin,elements:e.map((function(e){e.shape;return Object(o.a)(e,["shape"])}))});re("".concat(t,".json"),"data:text/plain;charset=utf-8,"+encodeURIComponent(n))}(e,t.name),{}},PanelComponent:function(e){var t=e.updateData;return h.a.createElement("button",{onClick:function(){return t(null)}},"Save as...")}},_e={name:"loadScene",perform:function(e,t,n){return{elements:n}},PanelComponent:function(e){var t=e.updateData;return h.a.createElement("button",{onClick:function(){(function(){var e=document.createElement("input"),t=new FileReader;return e.type="file",e.accept=".json",e.onchange=function(){e.files.length?t.readAsText(e.files[0],"utf8"):alert("A file was not selected.")},e.click(),new Promise((function(e){t.onloadend=function(){if(t.readyState===FileReader.DONE){var n=[];try{n=JSON.parse(t.result).elements||[]}catch(a){}e(oe(n,null))}}}))})().then((function(e){var n=e.elements;t(n)}))}},"Load file...")}},Ge="{}",Ze={name:"copyStyles",perform:function(e){var t=e.find((function(e){return e.isSelected}));return t&&(Ge=JSON.stringify(t)),{}},contextItemLabel:"Copy Styles",keyTest:function(e){return e[H]&&e.shiftKey&&"KeyC"===e.code},contextMenuOrder:0},Qe={name:"pasteStyles",perform:function(e){var t=JSON.parse(Ge);return{elements:e.map((function(e){if(e.isSelected){var n=Object(i.a)({},e,{shape:null,backgroundColor:null===t||void 0===t?void 0:t.backgroundColor,strokeWidth:null===t||void 0===t?void 0:t.strokeWidth,strokeColor:null===t||void 0===t?void 0:t.strokeColor,fillStyle:null===t||void 0===t?void 0:t.fillStyle,opacity:null===t||void 0===t?void 0:t.opacity,roughness:null===t||void 0===t?void 0:t.roughness});return B(n)&&(n.font=null===t||void 0===t?void 0:t.font,J(n)),n}return e}))}},contextItemLabel:"Paste Styles",keyTest:function(e){return e[H]&&e.shiftKey&&"KeyV"===e.code},contextMenuOrder:1},$e=function(e){var t=e.title,n=e.children,r=e.defaultCollapsed,o=void 0!==r&&r,i=e.hide,l=void 0!==i&&i,c=Object(d.useState)(o),u=Object(a.a)(c,2),s=u[0],f=u[1];return l?null:h.a.createElement("div",{className:"panel"},h.a.createElement("h4",null,t),h.a.createElement("button",{className:"btn-panel-collapse",type:"button",onClick:function(e){e.preventDefault(),f((function(e){return!e}))}},h.a.createElement("span",{className:"btn-panel-collapse-icon ".concat(s?"btn-panel-collapse-icon-closed":"")},"\u25bc")),!s&&h.a.createElement("div",{className:"panelColumn"},n))},et=function(e){var t=e.activeTool,n=e.onToolChange;return h.a.createElement($e,{title:"Shapes"},h.a.createElement("div",{className:"panelTools"},le.map((function(e){var a=e.value,r=e.icon;return h.a.createElement("label",{key:a,className:"tool",title:"".concat(z(a)," - ").concat(z(a)[0])},h.a.createElement("input",{type:"radio",checked:t===a,onChange:function(){n(a)}}),h.a.createElement("div",{className:"toolIcon"},r))}))))},tt=function(e){var t=e.actionManager,n=e.elements,a=e.appState,r=e.syncActionResult;return h.a.createElement("div",null,h.a.createElement("div",{className:"buttonList"},t.renderAction("bringForward",n,a,r),t.renderAction("bringToFront",n,a,r),t.renderAction("sendBackward",n,a,r),t.renderAction("sendToBack",n,a,r)))},nt=function(e){var t=e.actionManager,n=e.elements,a=e.appState,r=e.syncActionResult;return h.a.createElement($e,{title:"Canvas"},t.renderAction("changeViewBackgroundColor",n,a,r),t.renderAction("clearCanvas",n,a,r))},at=(n(23),function(){return h.a.createElement("svg",{viewBox:"0 0 384 512"},h.a.createElement("path",{fill:"currentColor",d:"M384 112v352c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h80c0-35.29 28.71-64 64-64s64 28.71 64 64h80c26.51 0 48 21.49 48 48zM192 40c-13.255 0-24 10.745-24 24s10.745 24 24 24 24-10.745 24-24-10.745-24-24-24m96 114v-20a6 6 0 0 0-6-6H102a6 6 0 0 0-6 6v20a6 6 0 0 0 6 6h180a6 6 0 0 0 6-6z"}))}),rt="toBlob"in HTMLCanvasElement.prototype&&"clipboard"in navigator&&"write"in navigator.clipboard&&"ClipboardItem"in window,ot=function(e){var t=e.actionManager,n=e.elements,a=e.appState,r=e.syncActionResult,o=e.onExportCanvas;return h.a.createElement($e,{title:"Export"},h.a.createElement("div",{className:"panelColumn"},t.renderAction("changeProjectName",n,a,r),h.a.createElement("h5",null,"Image"),h.a.createElement("div",{className:"panelExport-imageButtons"},h.a.createElement("button",{className:"panelExport-exportToPngButton",onClick:function(){return o("png")}},"Export to PNG"),rt&&h.a.createElement("button",{className:"panelExport-exportToClipboardButton",onClick:function(){return o("clipboard")},title:"Copy to clipboard (experimental)"},h.a.createElement(at,null))),t.renderAction("changeExportBackground",n,a,r),h.a.createElement("h5",null,"Scene"),t.renderAction("saveScene",n,a,r),t.renderAction("loadScene",n,a,r)))},it=function(e){var t=e.actionManager,n=e.syncActionResult,r=e.elements,o=e.onToolChange,i=e.appState,l=e.canvas;return h.a.createElement("div",{className:"sidePanel"},h.a.createElement(et,{activeTool:i.elementType,onToolChange:function(e){o(e)}}),h.a.createElement($e,{title:"Selection",hide:!Z(r)},h.a.createElement(tt,{actionManager:t,syncActionResult:n,elements:r,appState:i}),t.renderAction("changeStrokeColor",r,i,n),function(e){return e.some((function(e){return e.isSelected&&("rectangle"===e.type||"ellipse"===e.type||"diamond"===e.type)}))}(r)&&h.a.createElement(h.a.Fragment,null,t.renderAction("changeBackgroundColor",r,i,n),t.renderAction("changeFillStyle",r,i,n)),function(e){return e.some((function(e){return e.isSelected&&("rectangle"===e.type||"ellipse"===e.type||"diamond"===e.type||"arrow"===e.type)}))}(r)&&h.a.createElement(h.a.Fragment,null,t.renderAction("changeStrokeWidth",r,i,n),t.renderAction("changeSloppiness",r,i,n)),function(e){return e.some((function(e){return e.isSelected&&"text"===e.type}))}(r)&&h.a.createElement(h.a.Fragment,null,t.renderAction("changeFontSize",r,i,n),t.renderAction("changeFontFamily",r,i,n)),t.renderAction("changeOpacity",r,i,n),t.renderAction("deleteSelectedElements",r,i,n)),h.a.createElement(nt,{actionManager:t,syncActionResult:n,elements:r,appState:i}),h.a.createElement(ot,{actionManager:t,syncActionResult:n,elements:r,appState:i,onExportCanvas:function(e){return function(e,t,n,r){var o=r.exportBackground,i=r.exportPadding,l=void 0===i?10:i,c=r.viewBackgroundColor,u=r.name;if(!t.length)return window.alert("Cannot export empty canvas.");var s=1/0,f=0,d=1/0,h=0;function p(e,t){return Math.abs(e>t?e-t:t-e)}t.forEach((function(e){var t=C(e),n=Object(a.a)(t,4),r=n[0],o=n[1],i=n[2],l=n[3];s=Math.min(s,r),d=Math.min(d,o),f=Math.max(f,i),h=Math.max(h,l)}));var m=document.createElement("canvas");if(m.style.display="none",document.body.appendChild(m),m.width=p(s,f)+2*l,m.height=p(d,h)+2*l,ae(t,v.a.canvas(m),m,{viewBackgroundColor:o?c:null,scrollX:0,scrollY:0},{offsetX:-s+l,offsetY:-d+l,renderScrollbars:!1,renderSelection:!1}),"png"===e)re("".concat(u,".png"),m.toDataURL("image/png"));else if("clipboard"===e)try{m.toBlob((function(e){return ee.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee.a.awrap(navigator.clipboard.write([new window.ClipboardItem({"image/png":e})]));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),window.alert("Couldn't copy to clipboard. Try using Chrome browser.");case 8:case"end":return t.stop()}}),null,null,[[0,5]])}))}catch(g){window.alert("Couldn't copy to clipboard. Try using Chrome browser.")}m!==n&&m.remove()}(e,r.some((function(e){return e.isSelected}))?r.filter((function(e){return e.isSelected})):r,l,i)}}))};n.d(t,"viewportCoordsToSceneCoords",(function(){return mt})),n.d(t,"App",(function(){return vt}));var lt={elements:[]}.elements,ct={history:new ue}.history,ut="excalidraw-".concat(function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,a=e.getDate(),r=e.getHours(),o=e.getMinutes(),i=e.getSeconds();return"".concat(t).concat(n).concat(a).concat(r).concat(o).concat(i)}());function st(){document.documentElement.style.cursor=""}function ft(e,t,n){if(st(),null===t||""===t)return!1;var a=U(t,n);return e.text=t,e.font=n,e.x-=a.width/2,e.y-=a.height/2,e.width=a.width,e.height=a.height,e.baseline=a.baseline,!0}var dt=-1,ht=-1,pt=null;function mt(e,t){var n=e.clientX,a=e.clientY;return{x:n-250-t.scrollX,y:a-0-t.scrollY}}var vt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(u.a)(this,Object(s.a)(t).call(this,e))).canvas=null,n.rc=null,n.actionManager=new ge,n.syncActionResult=function(e){void 0!==e.elements&&(lt=e.elements,n.forceUpdate()),void 0!==e.appState&&n.setState(Object(i.a)({},e.appState))},n.state={draggingElement:null,resizingElement:null,elementType:"selection",exportBackground:!0,currentItemStrokeColor:"#000000",currentItemBackgroundColor:"#ffffff",currentItemFont:"20px Virgil",viewBackgroundColor:"#ffffff",scrollX:0,scrollY:0,cursorX:0,cursorY:0,name:ut},n.onResize=function(){n.forceUpdate()},n.getCurrentCursorPosition=function(e){n.setState({cursorX:e.x,cursorY:e.y})},n.onKeyDown=function(e){if(e.key===X)return lt=q(lt),n.forceUpdate(),n.setState({elementType:"selection"}),window.document.activeElement instanceof HTMLElement&&window.document.activeElement.blur(),void e.preventDefault();if(!W(e.target)){var t,a,r=n.actionManager.handleKeyDown(e,lt,n.state);if(n.syncActionResult(r),void 0===r.elements&&void 0===r.appState)if((a=e.key)===D||a===P||a===L||a===R){var o=e.shiftKey?5:1;lt=lt.map((function(t){if(t.isSelected){var n=Object(i.a)({},t);return e.key===D?n.x-=o:e.key===P?n.x+=o:e.key===R?n.y-=o:e.key===L&&(n.y+=o),n}return t})),n.forceUpdate(),e.preventDefault()}else if(ce.includes(e.key.toLowerCase()))n.setState({elementType:(t=e.key,le.reduce((function(e,n){return n.value[0]!==t?e:n.value}),"selection"))});else if(e[H]&&"KeyZ"===e.code){if(e.shiftKey){var l=ct.redoOnce(lt);null!==l&&(lt=l)}else{var c=ct.undoOnce(lt);null!==c&&(lt=c)}n.forceUpdate(),e.preventDefault()}}},n.removeWheelEventListener=void 0,n.copyToClipboard=function(){if(navigator.clipboard){var e=JSON.stringify(lt.filter((function(e){return e.isSelected})).map((function(e){e.shape;return Object(o.a)(e,["shape"])})));navigator.clipboard.writeText(e)}},n.pasteFromClipboard=function(){navigator.clipboard&&navigator.clipboard.readText().then((function(e){return n.addElementsFromPaste(e)}))},n.handleWheel=function(e){e.preventDefault();var t=e.deltaX,a=e.deltaY;n.setState((function(e){return{scrollX:e.scrollX-t,scrollY:e.scrollY-a}}))},n.addElementsFromPaste=function(e){var t;try{t=JSON.parse(e)}catch(v){}if(Array.isArray(t)&&t.length>0&&t[0].type){lt=q(lt);var o=1/0,i=0,l=1/0,c=0,u=Math.min.apply(Math,Object(r.a)(t.map((function(e){return e.x})))),s=Math.min.apply(Math,Object(r.a)(t.map((function(e){return e.y})))),f=function(e,t){return Math.abs(e>t?e-t:t-e)};t.forEach((function(e){var t=C(e),n=Object(a.a)(t,4),r=n[0],u=n[1],s=n[2],f=n[3];o=Math.min(o,r),l=Math.min(l,u),i=Math.max(i,s),c=Math.max(c,f)}));var d=f(o,i)/2,h=f(l,c)/2,p=n.state.cursorX-n.state.scrollX-250-d,m=n.state.cursorY-n.state.scrollY-0-h;lt=[].concat(Object(r.a)(lt),Object(r.a)(t.map((function(e){var t=x(e);return t.x+=p-u,t.y+=m-s,t})))),n.forceUpdate()}},n.actionManager.registerAction(ye),n.actionManager.registerAction(Me),n.actionManager.registerAction(Oe),n.actionManager.registerAction(ke),n.actionManager.registerAction(Ce),n.actionManager.registerAction(Ae),n.actionManager.registerAction(Le),n.actionManager.registerAction(Re),n.actionManager.registerAction(Ye),n.actionManager.registerAction(Xe),n.actionManager.registerAction(Ie),n.actionManager.registerAction(Ne),n.actionManager.registerAction(He),n.actionManager.registerAction(Ke),n.actionManager.registerAction(ze),n.actionManager.registerAction(We),n.actionManager.registerAction(Je),n.actionManager.registerAction(Ve),n.actionManager.registerAction(qe),n.actionManager.registerAction(_e),n.actionManager.registerAction(Ze),n.actionManager.registerAction(Qe),n}return Object(f.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("mousemove",this.getCurrentCursorPosition),window.addEventListener("resize",this.onResize,!1);var e=function(){var e=localStorage.getItem("excalidraw"),t=localStorage.getItem("excalidraw-state"),n=[];if(e)try{n=JSON.parse(e)}catch(r){}var a=null;if(t)try{a=JSON.parse(t)}catch(r){}return oe(n,a)}(),t=e.elements,n=e.appState;t&&(lt=t),n?this.setState(n):this.forceUpdate()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.onKeyDown,!1),document.removeEventListener("mousemove",this.getCurrentCursorPosition,!1),window.removeEventListener("resize",this.onResize,!1)}},{key:"render",value:function(){var e=this,t=window.innerWidth-250,n=window.innerHeight-0;return h.a.createElement("div",{className:"container",onCut:function(t){t.clipboardData.setData("text/plain",JSON.stringify(lt.filter((function(e){return e.isSelected})).map((function(e){e.shape;return Object(o.a)(e,["shape"])})))),lt=_(lt),e.forceUpdate(),t.preventDefault()},onCopy:function(e){e.clipboardData.setData("text/plain",JSON.stringify(lt.filter((function(e){return e.isSelected})).map((function(e){e.shape;return Object(o.a)(e,["shape"])})))),e.preventDefault()},onPaste:function(t){var n=t.clipboardData.getData("text");e.addElementsFromPaste(n),t.preventDefault()}},h.a.createElement(it,{actionManager:this.actionManager,syncActionResult:this.syncActionResult,appState:Object(i.a)({},this.state),elements:lt,onToolChange:function(t){e.setState({elementType:t}),lt=q(lt),document.documentElement.style.cursor="text"===t?"text":"crosshair",e.forceUpdate()},canvas:this.canvas}),h.a.createElement("canvas",{id:"canvas",style:{width:t,height:n},width:t*window.devicePixelRatio,height:n*window.devicePixelRatio,ref:function(a){null===e.canvas&&(e.canvas=a,e.rc=v.a.canvas(e.canvas)),e.removeWheelEventListener&&(e.removeWheelEventListener(),e.removeWheelEventListener=void 0),a&&(a.addEventListener("wheel",e.handleWheel,{passive:!1}),e.removeWheelEventListener=function(){return a.removeEventListener("wheel",e.handleWheel)},t===dt&&n===ht||(dt=t,ht=n,a.getContext("2d").scale(window.devicePixelRatio,window.devicePixelRatio)))},onContextMenu:function(t){t.preventDefault();var n=mt(t,e.state),a=n.x,o=n.y,i=ie(lt,a,o);i?(i.isSelected||(lt=q(lt),i.isSelected=!0,e.forceUpdate()),ve({options:[navigator.clipboard&&{label:"Copy",action:e.copyToClipboard},navigator.clipboard&&{label:"Paste",action:function(){return e.pasteFromClipboard()}}].concat(Object(r.a)(e.actionManager.getContextMenuItems(lt,e.state,e.syncActionResult))),top:t.clientY,left:t.clientX})):ve({options:[navigator.clipboard&&{label:"Paste",action:function(){return e.pasteFromClipboard()}}],top:t.clientY,left:t.clientX})},onMouseDown:function(o){if(null!==pt&&pt(o),0===o.button){o.preventDefault(),W(document.activeElement)&&document.activeElement.blur();var l=function(e,t,n,r,o,i,l){var c=V(e,r,o,i,l),u=[c.horizontal,c.vertical].map((function(e){return e&&e.x<=t&&t<=e.x+e.width&&e.y<=n&&n<=e.y+e.height})),s=Object(a.a)(u,2);return{isOverHorizontalScrollBar:s[0],isOverVerticalScrollBar:s[1]}}(lt,o.clientX-250,o.clientY-0,t,n,e.state.scrollX,e.state.scrollY),c=l.isOverHorizontalScrollBar,u=l.isOverVerticalScrollBar,s=mt(o,e.state),f=s.x,d=s.y,h=w(e.state.elementType,f,d,e.state.currentItemStrokeColor,e.state.currentItemBackgroundColor,"hachure",1,1,100),p=!1,m=!1,v=!1,g=null,y=!1;if("selection"===e.state.elementType){var b=F(lt,{x:f,y:d},e.state);if(e.setState({resizingElement:b?b.element:null}),b)p=b.resizeHandle,document.documentElement.style.cursor="".concat(p,"-resize"),m=!0;else ie(lt.filter((function(e){return e.isSelected})),f,d)||o.shiftKey||(lt=q(lt)),(g=ie(lt,f,d))&&(g.isSelected||(g.isSelected=!0,y=!0),o.altKey&&(lt=[].concat(Object(r.a)(lt),Object(r.a)(lt.reduce((function(e,t){return t.isSelected&&(e=e.concat(x(t)),t.isSelected=!1),e}),[])))))}else lt=q(lt);if(B(h)){var E=o.clientX,S=o.clientY;if(!o.altKey){var k=e.getTextWysiwygSnappedToCenterPosition(f,d);k&&(h.x=k.elementCenterX,h.y=k.elementCenterY,E=k.wysiwygX,S=k.wysiwygY)}K({initText:"",x:E,y:S,strokeColor:e.state.currentItemStrokeColor,font:e.state.currentItemFont,onSubmit:function(t){ft(h,t,e.state.currentItemFont),lt=[].concat(Object(r.a)(lt),[Object(i.a)({},h,{isSelected:!0})]),e.setState({draggingElement:null,elementType:"selection"})}})}else{"text"===e.state.elementType?(lt=[].concat(Object(r.a)(lt),[Object(i.a)({},h,{isSelected:!0})]),e.setState({draggingElement:null,elementType:"selection"})):(lt=[].concat(Object(r.a)(lt),[h]),e.setState({draggingElement:h}));var M=f,O=d;(c||u)&&(M=o.clientX-250,O=o.clientY-0);var A=function(t){var n;if(t.target instanceof HTMLElement){if(c){var r=t.clientX-250,o=r-M;return e.setState((function(e){return{scrollX:e.scrollX-o}})),void(M=r)}if(u){var i=t.clientY-0,l=i-O;return e.setState((function(e){return{scrollY:e.scrollY-l}})),void(O=i)}if(m&&e.state.resizingElement){var s=e.state.resizingElement,f=lt.filter((function(e){return e.isSelected}));if(1===f.length){var d=mt(t,e.state),h=d.x,y=d.y;return f.forEach((function(e){switch(p){case"nw":e.width+=e.x-M,e.x=M,t.shiftKey?(e.y+=e.height-e.width,e.height=e.width):(e.height+=e.y-O,e.y=O);break;case"ne":e.width=M-e.x,t.shiftKey?(e.y+=e.height-e.width,e.height=e.width):(e.height+=e.y-O,e.y=O);break;case"sw":e.width+=e.x-M,e.x=M,t.shiftKey?e.height=e.width:e.height=O-e.y;break;case"se":e.width+=h-M,t.shiftKey?e.height=e.width:e.height+=y-O;break;case"n":e.height+=e.y-O,e.y=O;break;case"w":e.width+=e.x-M,e.x=M;break;case"s":e.height=O-e.y;break;case"e":e.width=M-e.x}s.x=e.x,s.y=e.y,s.shape=null})),M=h,O=y,ct.skipRecording(),void e.forceUpdate()}}if(null===(n=g)||void 0===n?void 0:n.isSelected){v=!0;var b=lt.filter((function(e){return e.isSelected}));if(b.length){var E=mt(t,e.state),w=E.x,x=E.y;return b.forEach((function(e){e.x+=w-M,e.y+=x-O})),M=w,O=x,ct.skipRecording(),void e.forceUpdate()}}var S=e.state.draggingElement;if(S){var k=t.clientX-250-S.x-e.state.scrollX,A=t.clientY-0-S.y-e.state.scrollY;S.width=k,S.height=t.shiftKey?Math.abs(k)*Math.sign(A):A,S.shape=null,"selection"===e.state.elementType&&(lt=function(e,t){var n=C(t),r=Object(a.a)(n,4),o=r[0],i=r[1],l=r[2],c=r[3];return e.forEach((function(e){var t=C(e),n=Object(a.a)(t,4),r=n[0],u=n[1],s=n[2],f=n[3];e.isSelected="selection"!==e.type&&o<=r&&i<=u&&l>=s&&c>=f})),e}(lt,S)),ct.skipRecording(),e.forceUpdate()}}},j=function t(n){var a=e.state,r=a.draggingElement,o=a.elementType;if(pt=null,window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",t),st(),!g||v||y||(n.shiftKey?g.isSelected=!1:(lt=q(lt),g.isSelected=!0)),null===r)return lt=q(lt),void e.forceUpdate();"selection"===o?lt=lt.slice(0,-1):r.isSelected=!0,e.setState({draggingElement:null,elementType:"selection"}),ct.resumeRecording(),e.forceUpdate()};pt=j,window.addEventListener("mousemove",A),window.addEventListener("mouseup",j),ct.skipRecording(),e.forceUpdate()}}},onDoubleClick:function(t){var n=mt(t,e.state),a=n.x,o=n.y,l=ie(lt,a,o),c=w("text",a,o,e.state.currentItemStrokeColor,e.state.currentItemBackgroundColor,"hachure",1,1,100),u="",s=t.clientX,f=t.clientY;if(l&&B(l))lt=lt.filter((function(e){return e.id!==l.id})),e.forceUpdate(),Object.assign(c,l),c.x=l.x+l.width/2,c.y=l.y+l.height/2,u=l.text,s=e.state.scrollX+l.x+250+l.width/2,f=e.state.scrollY+l.y+0+l.height/2;else if(!t.altKey){var d=e.getTextWysiwygSnappedToCenterPosition(a,o);d&&(c.x=d.elementCenterX,c.y=d.elementCenterY,s=d.wysiwygX,f=d.wysiwygY)}K({initText:u,x:s,y:f,strokeColor:c.strokeColor,font:c.font||e.state.currentItemFont,onSubmit:function(t){ft(c,t,c.font||e.state.currentItemFont),lt=[].concat(Object(r.a)(lt),[Object(i.a)({},c,{isSelected:!0})]),e.setState({draggingElement:null,elementType:"selection"})}})},onMouseMove:function(t){if(!Boolean(t.buttons)&&"selection"===e.state.elementType){var n=mt(t,e.state),a=n.x,r=n.y,o=F(lt,{x:a,y:r},e.state);if(o&&o.resizeHandle)document.documentElement.style.cursor="".concat(o.resizeHandle,"-resize");else{var i=ie(lt,a,r);if(i){var l=T(i,a,r,{scrollX:e.state.scrollX,scrollY:e.state.scrollY});document.documentElement.style.cursor=l?"".concat(l,"-resize"):"move"}else document.documentElement.style.cursor=""}}}}))}},{key:"getTextWysiwygSnappedToCenterPosition",value:function(e,t){var n=function(e,t,n){for(var r=null,o=e.length-1;o>=0;--o){var i=C(e[o]),l=Object(a.a)(i,4),c=l[0],u=l[1],s=l[2],f=l[3];if(c<t&&t<s&&u<n&&n<f){r=e[o];break}}return r}(lt,e,t);if(n){var r=n.x+n.width/2,o=n.y+n.height/2;if(Math.hypot(e-r,t-o)<30)return{wysiwygX:this.state.scrollX+n.x+250+n.width/2,wysiwygY:this.state.scrollY+n.y+0+n.height/2,elementCenterX:r,elementCenterY:o}}}},{key:"componentDidUpdate",value:function(){var e,t;ae(lt,this.rc,this.canvas,{scrollX:this.state.scrollX,scrollY:this.state.scrollY,viewBackgroundColor:this.state.viewBackgroundColor}),e=lt,t=this.state,localStorage.setItem("excalidraw",JSON.stringify(e)),localStorage.setItem("excalidraw-state",JSON.stringify(t)),ct.isRecording()&&(ct.pushEntry(ct.generateCurrentEntry(lt)),ct.clearRedoStack())}}]),t}(h.a.Component),gt=document.getElementById("root");m.a.render(h.a.createElement(vt,null),gt)}},[[15,1,3]],[2]]);
//# sourceMappingURL=main.91f7a678.chunk.js.map